

import java.net.UnknownHostException;
import com.mongodb.BasicDBObject;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.MongoClient;
import com.mongodb.MongoException;


public class test1 {
      public static void main(String[] args) {
 
    try {
 
	/**** Connect to MongoDB ****/
	MongoClient mongo = new MongoClient("localhost", 27017);
 
	/**** Get database ****/
	DB db = mongo.getDB("demo");
 
	/**** Get collection / table from 'demo' ****/
	DBCollection table = db.getCollection("t6batch");
 
	/**** Insert ****/
	BasicDBObject doc = new BasicDBObject();
	doc.put("NAME", "Rahul");
	doc.put("AGE", 30);
	table.insert(doc);
	BasicDBObject doc1 = new BasicDBObject();
	doc1.put("NAME", "Arya");
	doc1.put("AGE", 2);
	table.insert(doc1);
	
	/**** Display ****/
	System.out.println(doc);
	System.out.println(doc1);
 
	/**** Update ****/
	BasicDBObject newDocument = new BasicDBObject();
	newDocument.append("$set", new BasicDBObject().append("AGE", 31));
				
	BasicDBObject searchQuery = new BasicDBObject().append("NAME", "Rahul");

	table.update(searchQuery, newDocument);
	
	/**** Remove****/
	BasicDBObject document = new BasicDBObject();
	document.put("AGE", 2);
	table.remove(document);
	
/*table.remove(doc1);*/
	
   
	/**** Done ****/
	System.out.println("Done");
 
    } catch (UnknownHostException e) {
	e.printStackTrace();
    } catch (MongoException e) {
	e.printStackTrace();
    }
 
  }
}
